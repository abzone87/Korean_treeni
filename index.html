<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Korean Vocabulary Practice</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 1em;
      max-width: 600px;
      margin: auto;
    }
    button {
      padding: 0.5em 1em;
      font-size: 1em;
      cursor: pointer;
      margin: 0.25em;
    }
    input {
      padding: 0.5em;
      font-size: 1em;
      margin: 0.5em;
    }
    .feedback {
      margin-top: 1em;
      font-weight: bold;
    }
    #score {
      margin-top: 1em;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>
  <h1 style="text-align: center;">Korean Vocabulary Practice</h1>
  <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 0.5em;">
    <button onclick="setMode('mc-ko-en')">Korean â†’ English (MC)</button>
    <button onclick="setMode('mc-en-ko')">English â†’ Korean (MC)</button>
    <button onclick="setMode('write-ko-en')">Korean â†’ English (Write)</button>
    <button onclick="setMode('write-en-ko')">English â†’ Korean (Write)</button>
    <button onclick="setMode('listen-ko-en')">ðŸŽ§ Listen â†’ English</button>
  </div>
  <hr>
  <div id="practiceArea" style="text-align: center; margin-top: 1em;"></div>
  <div id="score"></div>

 <script src="https://cdn.jsdelivr.net/gh/abzone87/Korean_treeni/words.js"></script>
  <script>
    let current = {};
    let mode = '';
    let score = 0;
    let total = 0;
    let groupWords = [];

    function setMode(m) {
      mode = m;
      nextQuestion();
    }

    function nextQuestion() {
      const area = document.getElementById('practiceArea');
      area.innerHTML = '';
      const feedback = document.createElement('div');
      feedback.className = 'feedback';

      if (groupWords.length === 0) {
        groupWords = words;
      }

      current = groupWords[Math.floor(Math.random() * groupWords.length)];

      if (mode === 'mc-ko-en' || mode === 'mc-en-ko') {
        const question = document.createElement('div');
        question.textContent = mode === 'mc-ko-en' ? current.korean : current.english;
        area.appendChild(question);

        const options = shuffle([current, ...getRandomOptions(3)]);
        options.forEach(opt => {
          const btn = document.createElement('button');
          btn.textContent = mode === 'mc-ko-en' ? opt.english : opt.korean;
          btn.onclick = () => {
            const correct = (opt === current);
            feedback.textContent = correct ? 'âœ… Correct!' : 'âŒ Wrong!';
            area.appendChild(feedback);
            updateStats(current, correct);
            if (correct) setTimeout(nextQuestion, 1000);
          };
          area.appendChild(btn);
        });

      } else if (mode === 'write-ko-en' || mode === 'write-en-ko') {
        const question = document.createElement('div');
        question.textContent = mode === 'write-ko-en' ? current.korean : current.english;
        area.appendChild(question);

        const input = document.createElement('input');
        input.type = 'text';
        area.appendChild(input);

        const btn = document.createElement('button');
        btn.textContent = 'Check';
        btn.onclick = () => {
          const answer = input.value.trim().toLowerCase();
          const correctAnswer = (mode === 'write-ko-en' ? current.english : current.korean).toLowerCase();
          const correct = answer === correctAnswer;
          feedback.textContent = correct ? 'âœ… Correct!' : `âŒ Wrong! Correct answer: ${correctAnswer}`;
          area.appendChild(feedback);
          updateStats(current, correct);
          if (correct) setTimeout(nextQuestion, 1000);
        };
        area.appendChild(btn);

      } else if (mode === 'listen-ko-en') {
        const utterance = new SpeechSynthesisUtterance(current.korean);
        utterance.lang = 'ko-KR';
        speechSynthesis.speak(utterance);

        const question = document.createElement('div');
        question.textContent = 'What is the meaning of the spoken Korean word?';
        area.appendChild(question);

        const replayBtn = document.createElement('button');
        replayBtn.textContent = 'ðŸ” Listen again';
        replayBtn.onclick = () => speechSynthesis.speak(utterance);
        area.appendChild(replayBtn);

        const options = shuffle([current, ...getRandomOptions(3)]);
        options.forEach(opt => {
          const btn = document.createElement('button');
          btn.textContent = opt.english;
          btn.onclick = () => {
            const correct = (opt === current);
            feedback.textContent = correct ? 'âœ… Correct!' : 'âŒ Wrong!';
            area.appendChild(feedback);
            updateStats(current, correct);
            if (correct) setTimeout(nextQuestion, 1000);
          };
          area.appendChild(btn);
        });
      }

      const nextBtn = document.createElement('button');
      nextBtn.textContent = 'Next';
      nextBtn.onclick = nextQuestion;
      area.appendChild(document.createElement('br'));
      area.appendChild(nextBtn);
    }

    function getRandomOptions(n) {
      const filtered = groupWords.filter(w => w !== current);
      const shuffled = filtered.sort(() => 0.5 - Math.random());
      return shuffled.slice(0, n);
    }

    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function updateStats(word, correct) {
      const key = word.korean + '|' + word.english;
      const stats = JSON.parse(localStorage.getItem('wordStats') || '{}');
      if (!stats[key]) stats[key] = { correct: 0, total: 0 };
      stats[key].total += 1;
      if (correct) stats[key].correct += 1;
      localStorage.setItem('wordStats', JSON.stringify(stats));
      updateScoreDisplay();
    }

    function updateScoreDisplay() {
      const stats = JSON.parse(localStorage.getItem('wordStats') || '{}');
      let correct = 0, total = 0;
      for (const key in stats) {
        correct += stats[key].correct;
        total += stats[key].total;
      }
      document.getElementById('score').textContent = `Score: ${correct} / ${total}`;
    }

    window.onload = () => {
      updateScoreDisplay();
      setMode('mc-ko-en');
    };
  </script>
</body>
</html>


</body>
</html>

